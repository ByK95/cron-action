name: "Find Ongoing Feature Flags"
description: ""
inputs:
  matcher:
    required: true
    description: "regex pattern of any code that will be matched"
    type: string
  file_type:
    required: true
    description: "File type that search will happen ex: py"
    type: string
runs:
  using: "composite"
  steps:
  - uses: actions/checkout@v3
  - uses: actions/setup-python@v4
    with:
      python-version: '3.10'
  - name: Find Usages
    shell: bash
    run: |
      git grep -E "${{ inputs.matcher }}" -- '*.${{ inputs.file_type }}' |
      python main.py |
      tee >(xargs -I '{}' git log -1 -S '{}' --pretty=format:'(%cd) %n') |
      tac |
      python parse.py
